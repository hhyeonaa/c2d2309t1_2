<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team.mappers.teamMapper">

	<select id="selectCodeList" parameterType="map" resultType="map">
	
		select  CO_TYPE
			  , CO_NO
			  , CODE
		 	  , CASE WHEN #{AD_ROLE} = '1'  then HIDE
		 	  		 WHEN #{AD_ROLE} != '1' then ACTIVE END AS "HIDE"
		  from CODE
		 where 1 = 1  
		   and CO_TYPE = #{codeType}
	  <choose>
	    <when test="AD_ROLE == '1'">
		   and HIDE in ('0', '1') 					 	
		</when>
		<when test="AD_ROLE == '2'">
		   and HIDE = '0' 					 	
		</when>
		<when test="AD_ROLE == '3'">
		   and HIDE = '0' 					 	
		</when>
		<otherwise>
		   and ACTIVE = '0'	
		</otherwise>
	  </choose>  
		 order by cast(CO_NO as signed) desc 	   
		    
	</select>
	
	<select id="selectCode" parameterType="map" resultType="map">
	
		select CODE
		  from CODE			
		 where 1 = 1
		   and CO_NO = #{CO_NO}
		   and CO_TYPE = #{CO_TYPE}
		<if test="AD_ROLE == '1'">
		   and HIDE in ('0', '1')
		</if>
		<if test="AD_ROLE != '1'">
		   and HIDE = '0'
		</if>
	     order by cast(CO_NO as signed) desc  
	     
	</select>
	
	<select id="selectMessage" parameterType="map" resultType="map">
	
		select CODE
		  from MESSAGE			
		 where 1 = 1
		   and CO_NO = #{CO_NO}
		   and CO_TYPE = #{CO_TYPE}
		<if test="AD_ROLE == '1'">
		   and HIDE in ('0', '1')
		</if>
		<if test="AD_ROLE != '1'">
		   and HIDE = '0'
		</if>
	     order by cast(CO_NO as signed) desc  
	     
	</select>

	<select id="selectMessageList" parameterType="map" resultType="map">
		
		select  CO_TYPE
			  , CO_NO
			  , CODE
		 	  , HIDE
		  from MESSAGE
		 where 1 = 1  
		   and CO_TYPE = #{codeType}
	  	<if test="AD_ROLE == '1'">
		   and HIDE in ('0', '1')
		</if>
		<if test="AD_ROLE != '1'">
		   and HIDE = '0'
		</if>  
		 order by cast(CO_NO as signed) desc
		
	</select>

</mapper>